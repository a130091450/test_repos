<mxfile host="app.diagrams.net" modified="2021-06-07T03:25:58.887Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.77 Safari/537.36 Edg/91.0.864.37" etag="S9SlEjKT8lRQ7KvghcOU" version="14.7.6" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="569" dy="331" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-23" value="充币流程(SafeSyncJob)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="276.5" y="15" width="140" height="10" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=20;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-24">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-24" value="" style="shape=waypoint;sketch=0;fillStyle=solid;size=6;pointerEvents=1;points=[];fillColor=none;resizable=0;rotatable=0;perimeter=centerPerimeter;snapToPoint=1;fontSize=20;strokeWidth=1;spacing=5;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="330" y="40" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-27" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=20;strokeWidth=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="289" y="120" width="125" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-15" value="校验：&#xa;判断链是否上线状态：&#xa;1.拉取configHolder的chainName&#xa;2.通过chainName查询数据&#xa;库plutus_general.general_chain&#xa;3. 通过查询结果判断链是否为上线状态" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="291.5" y="120" width="118.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-30" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;fontSize=20;exitX=0.515;exitY=0.986;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-15">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="470" y="200" as="sourcePoint" />
            <mxPoint x="353" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-31" value="" style="html=1;whiteSpace=wrap;aspect=fixed;shape=isoRectangle;fontSize=20;strokeWidth=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="309.84" y="210" width="83.33" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-32" value="" style="endArrow=classic;html=1;fontSize=20;exitX=0.017;exitY=0.467;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-31">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="470" y="200" as="sourcePoint" />
            <mxPoint x="260" y="233" as="targetPoint" />
            <Array as="points">
              <mxPoint x="290" y="233" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-33" value="" style="shape=waypoint;sketch=0;fillStyle=solid;size=6;pointerEvents=1;points=[];fillColor=none;resizable=0;rotatable=0;perimeter=centerPerimeter;snapToPoint=1;fontSize=20;strokeWidth=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="213" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-20" value="链为下线状态" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="264" y="213" width="46" height="14" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-35" value="SafeSyncJob定时任务" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="350" y="80" width="70" height="14" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-36" value="" style="endArrow=classic;html=1;fontSize=20;exitX=0.505;exitY=1.015;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-31">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="300" as="sourcePoint" />
            <mxPoint x="352" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-37" value="链为上线状态" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="350" y="264" width="46" height="14" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-41" value="" style="html=1;whiteSpace=wrap;aspect=fixed;shape=isoRectangle;fontSize=20;strokeWidth=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="312.34" y="370" width="83.33" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-43" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;fontSize=20;exitX=0.511;exitY=1.039;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.51;entryY=0.02;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-38" target="nfLF9BBbHPyzlX6y-_Kb-41">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="330" as="sourcePoint" />
            <mxPoint x="430" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-44" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="291.5" y="300" width="125" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-39" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=20;strokeWidth=1;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-44">
          <mxGeometry width="125" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-38" value="获取区块高度(要扫描的区块):&#xa;1.获取链上高度&#xa;2.获取plutus_chain.node_sync_height中该链的高度&#xa;3.根据确认数判断是否需要扫新块" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-44">
          <mxGeometry x="2.5" width="116" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-46" value="" style="shape=waypoint;sketch=0;fillStyle=solid;size=6;pointerEvents=1;points=[];fillColor=none;resizable=0;rotatable=0;perimeter=centerPerimeter;snapToPoint=1;fontSize=20;strokeWidth=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="375" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-47" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;fontSize=20;exitX=0.014;exitY=0.494;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.615;entryY=0.447;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-41" target="nfLF9BBbHPyzlX6y-_Kb-46">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="330" as="sourcePoint" />
            <mxPoint x="430" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-48" value="无新块" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="272" y="375" width="30" height="14" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-49" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;fontSize=20;exitX=0.508;exitY=0.979;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="nfLF9BBbHPyzlX6y-_Kb-41">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="380" as="sourcePoint" />
            <mxPoint x="355" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-60" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="324.75" y="450" width="58.5" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-50" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=20;strokeWidth=1;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-60">
          <mxGeometry width="58.5" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-59" value="扫块返回块信息" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-60">
          <mxGeometry width="58.5" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-61" value="" style="endArrow=classic;html=1;fontSize=20;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="354" y="470" as="sourcePoint" />
            <mxPoint x="353.72" y="508" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-64" value="有新块" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="353.25" y="420" width="30" height="14" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-65" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="296.5" y="510" width="123.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-62" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=20;strokeWidth=1;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-65">
          <mxGeometry width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-63" value="过滤地址：&#xa;1.拿到块中地址查询，通过查询数据库&#xa;plutus_general.general_address, 过滤掉&#xa;不属于数据库中的地址，最后拿到与我&#xa;们有关的交易地址" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-65">
          <mxGeometry x="5" y="5" width="118.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-66" value="" style="endArrow=classic;html=1;fontSize=20;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="353.72" y="570" as="sourcePoint" />
            <mxPoint x="353.72" y="630" as="targetPoint" />
            <Array as="points">
              <mxPoint x="353.72" y="600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-71" value="" style="group" vertex="1" connectable="0" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="260" y="630" width="181.70040485829958" height="100" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-69" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=20;strokeWidth=1;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-71">
          <mxGeometry width="181.70040485829958" height="100" as="geometry" />
        </mxCell>
        <mxCell id="nfLF9BBbHPyzlX6y-_Kb-70" value="更新相关交易入库(更新以下数据库信息)&#xa;1.plutus_chain.node_block_info(插入新扫描的区块信息)&#xa;2.更新plutus_chain.node_block_info&#xa;3.更新plutus_chain.node_transaction_info_balance&#xa;4.插入plutus_chain.node_transaction_info_balance新的交易&#xa;5.更新plutus_chain.node_transaction_info_utxo&#xa;6.插入plutus_chain.node_transaction_info_utxo新的交易&#xa;7.更新和插入plutus_chain.utxo&#xa;8.更新plutus_chain.node_address_nonce&#xa;9.更新订单plutus_chain.node_out_order&#xa;10.更新区块高度plutus_chain.node_sync_height" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;strokeWidth=1;perimeterSpacing=1;fontSize=6;" vertex="1" parent="nfLF9BBbHPyzlX6y-_Kb-71">
          <mxGeometry x="2.2708502024291306" y="8.333333333333371" width="179.42914979757086" height="83.33333333333334" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
